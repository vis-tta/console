name: Release Creation Action
on:
  pull_request:
    types: [labeled, milestoned]
jobs:
  Release:
    runs-on: ubuntu-latest
    container:
      image: node:22
    if: contains(github.event.pull_request.labels.*.name, 'Project/Release')
    steps:
      - uses: actions/checkout@v3
        with:
          clean: true

      - name: Print full event payload
        run: |
          version="${{ gitea.event.pull_request.milestone.title }}"
          echo "Release: $version"
          if [[ "$version" =~ "v[0-9]+\.[0-9]+\.[0-9]+" ]]; then
            package_version=$(jq -r .version package.json)
            if [[ "$version" > "$package_version" ]]; then
              echo "PR version is above package.json version."
            else
              echo "PR version is not above package.json version."
            fi
          else
            echo "Invalid version format in PR title."
          fi